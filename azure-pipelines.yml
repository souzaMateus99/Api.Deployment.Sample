trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: DotNetCoreCLI@2
  displayName: Build
  inputs:
    command: 'build'
    projects: 'Api.Deployment.Sample/Api.Deployment.Sample.csproj'
- task: DotNetCoreCLI@2
  displayName: Publish
  inputs:
    command: 'publish'
    publishWebProjects: true
    arguments: '-c Release -o Api.Deployment.Sample/bin/Release/netcoreapp3.1'
    workingDirectory: 'Api.Deployment.Sample/Api.Deployment.Sample.csproj'
- script: |
    mkdir artifact
    cp -r Api.Deployment.Sample/bin/Release/netcoreapp3.1 artifact/$(Build.SourceBranchName)
  displayName: Run Script
- task: PublishPipelineArtifact@1
  displayName: Publish Artifact
  inputs:
    targetPath: '$(System.DefaultWorkingDirectory)/artifact'
    artifact: 'ApiDeploymentSample'    